# ðŸš€ START HERE - Intune Deployment

## Welcome!

You want to deploy the Oricol Endpoint Monitoring Agent through Microsoft Intune. You're in the right place!

## âš¡ Choose Your Path

### ðŸƒ I Want to Deploy NOW (35 minutes)
**Path**: Fast Track

**Start here**: `QUICK_START.md`

You'll:
1. Generate tokens (2 min)
2. Run automated package script (5 min)
3. Upload to Intune (15 min)
4. Deploy and verify (10 min)

**Go to**: [QUICK_START.md](QUICK_START.md)

---

### ðŸ“š I Want Detailed Instructions (45 minutes)
**Path**: Comprehensive Guide

**Start here**: `intune/DEPLOYMENT_GUIDE.md`

You'll get:
- 7 phases with step-by-step instructions
- Screenshots references
- Phased rollout planning
- Complete troubleshooting guide

**Go to**: [intune/DEPLOYMENT_GUIDE.md](intune/DEPLOYMENT_GUIDE.md)

---

### ðŸ”§ I Want to Understand the Scripts (15 minutes)
**Path**: Technical Reference

**Start here**: `intune/README.md`

You'll learn:
- What each helper script does
- How to customize for your environment
- Advanced configuration options
- Integration with existing tools

**Go to**: [intune/README.md](intune/README.md)

---

### ðŸ—ºï¸ I Want to See Everything (5 minutes)
**Path**: Navigation Guide

**Start here**: `INTUNE_QUICK_REFERENCE.md`

You'll find:
- Complete documentation map
- Quick command reference
- Links to all resources
- Common issues quick fixes

**Go to**: [INTUNE_QUICK_REFERENCE.md](INTUNE_QUICK_REFERENCE.md)

---

## ðŸŽ¯ Most Common Use Case

**Scenario**: "I have Intune, I have Supabase, I want to deploy to all my Windows devices"

**Answer**: Follow these 5 steps:

### Step 1: Get Your Credentials (5 min)
- Supabase URL: Project Settings > API
- Supabase Anon Key: Project Settings > API

### Step 2: Generate Token (2 min)
```powershell
.\Generate-AgentTokens.ps1 -Count 1 -OutputFile "tokens.csv"
# Apply the generated SQL in Supabase
```

### Step 3: Prepare Package (5 min)
```powershell
cd intune
.\Prepare-IntunePackage.ps1 `
    -SupabaseUrl "https://your-project.supabase.co" `
    -SupabaseAnonKey "your-key" `
    -AgentToken "your-token" `
    -OutputPath "C:\IntunePackages"
```

### Step 4: Upload to Intune (15 min)
- Go to: https://endpoint.microsoft.com
- Apps > Windows > Add > Win32
- Upload the .intunewin file
- Use install command from script output
- Set detection: Registry key `HKLM\SYSTEM\CurrentControlSet\Services\OricolEndpointAgent`

### Step 5: Deploy (5 min)
- Assign to "All Devices" or your groups
- Set as Required
- Hide notifications
- Deploy!

**Done!** Devices will start appearing in your dashboard within 10 minutes.

---

## ðŸ“ Files You Need

### Essential Files
âœ… `OricolEndpointAgent.ps1` - The main agent (already here)  
âœ… `Generate-AgentTokens.ps1` - Creates secure tokens (already here)  
âœ… `intune/Prepare-IntunePackage.ps1` - Automated packaging (already here)

### You Need to Download
ðŸ“¥ **Microsoft Win32 Content Prep Tool**
- URL: https://github.com/microsoft/Microsoft-Win32-Content-Prep-Tool/releases
- File: IntuneWinAppUtil.exe
- Save to: Any location (you'll specify path)

### Created Automatically
ðŸ”„ `config.json` - Generated by Prepare-IntunePackage.ps1  
ðŸ”„ `nssm.exe` - Downloaded by Prepare-IntunePackage.ps1  
ðŸ”„ `*.intunewin` - Package file created for upload

---

## â“ FAQ

### Do I need admin access to Intune?
Yes - Global Administrator or Intune Administrator role required.

### Do I need admin rights on my PC?
Yes - To run the package preparation script.

### How long does deployment take?
- Package prep: 10 minutes
- Intune upload: 5 minutes  
- Device installation: 5-10 minutes per device
- Total for pilot (50 devices): ~30 minutes

### Will users see anything?
No - Completely silent installation. No prompts, no windows, no notifications.

### What if something fails?
See troubleshooting in:
1. `intune/README.md` - Quick fixes
2. `intune/DEPLOYMENT_GUIDE.md` Phase 6 - Detailed solutions

### Can I deploy to specific groups only?
Yes - When assigning in Intune, select your security group instead of "All Devices".

### How do I know it's working?
Check:
1. Intune Admin Center > Your App > Device install status
2. Oricol Dashboard > Endpoint Monitoring (devices appear within 5 min)
3. On device: `Get-Service -Name OricolEndpointAgent` (should be Running)

---

## ðŸ†˜ Need Help?

### Documentation
- **Quick Start**: `QUICK_START.md`
- **Detailed Guide**: `intune/DEPLOYMENT_GUIDE.md`
- **Scripts Reference**: `intune/README.md`
- **Navigation**: `INTUNE_QUICK_REFERENCE.md`

### Support
- **Email**: support@oricol.co.za
- **Dashboard**: Click "?" icon
- **Logs**: `C:\ProgramData\Oricol\EndpointAgent\Logs\`

### Common Issues
| Problem | Quick Fix |
|---------|-----------|
| Can't find IntuneWinAppUtil.exe | Download from [Microsoft GitHub](https://github.com/microsoft/Microsoft-Win32-Content-Prep-Tool/releases) |
| Package creation fails | Run PowerShell as Administrator |
| Intune deployment fails | Check device meets requirements (Win10 1809+) |
| Agent not reporting | Verify config.json credentials, check network |

---

## âœ… Prerequisites Checklist

Before you start, make sure you have:

- [ ] **Microsoft 365 Intune access** (admin role)
- [ ] **Supabase project** (with endpoint monitoring backend)
- [ ] **Supabase credentials** (URL and Anon Key)
- [ ] **Windows PC** (for package preparation)
- [ ] **Administrator rights** (on your PC)
- [ ] **PowerShell 5.1+** (usually pre-installed)
- [ ] **Win32 Content Prep Tool** (download from GitHub)
- [ ] **Target devices** (Windows 10 1809+ enrolled in Intune)

---

## ðŸŽ‰ Ready to Go!

Pick your path above and get started. The scripts will guide you through the rest!

**Tip**: Most people start with `QUICK_START.md` for the fastest results.

---

**Last Updated**: December 2024  
**Version**: 1.0.0  
**Quick Links**:
- [Quick Start Guide](QUICK_START.md)
- [Detailed Deployment Guide](intune/DEPLOYMENT_GUIDE.md)
- [Scripts Reference](intune/README.md)
- [Quick Reference Card](INTUNE_QUICK_REFERENCE.md)
